function excs = simulate_wendlingModel(Param)
P = wendModel_params('Cij',Param.Cij,'C',Param.globalcoupling,'D',Param.strength);
% P = wendModel_params('Cij',Param.Cij,'Dij',Param.Dij,'C',Param.globalcoupling);
N = P.N;
dt = Param.dt_ms;
Nt = Param.duration_ms;
% D_ndt = cal_delay(dt, P.Dij, 3);
% startind = max(D_ndt, [], 'all') + 1;
excs = zeros(N, Nt/dt+1);%68*2001
yinit = zeros(8*N, 1);
fs = 1000;
re = 1/fs;
%pulse = 0;
pulse_array = zeros(Nt/dt+1, N);
for i = 2 : length(excs)
    pt = random('Normal', 90, 30, N, 1);
    % if i == 2
    %     Cij = P.Cij_pre;
    %     save('Data/Cij.mat', 'Cij');
    % end
    % data = load("Cij.mat");
    % W1 = data.Cij;
    stim = zeros(P.N, 1);%Stimulation is off 
    
    % stim_duration_ms = 5;
    % stim_start_time = [];  
    %  if (i >= 1001) && (i <= 40000)
    %     for h = 0:49
    %         % 在指定时间施加刺激
    %         if (i == 1001 + 100 * h) || (i == 14001 + 100 * h)||(i == 27001 + 100 * h)
    %             stim_start_time = i;  % 记录刺激开始时间
    %         end
    %         if ~isempty(stim_start_time) && (i >= stim_start_time) && (i < stim_start_time + stim_duration_ms)
    %             stim = 1.5 * [-0.008288155 0.011350203 0.001330774 -0.005082752 0.001697164 -0.003977708 -0.008418657 -0.004810917 -0.001968068 -0.006554444 0.011619756 -0.003831315 0.017484881 -0.005998375 -0.001512103 -0.002112704 0.000994136 0.01141731 0.00847799 -0.004561759 -0.008062828 0.001378504 -0.005138937 -0.00441773 0.017690486 0.01638853 0.014794653 -0.007721082 -0.005515299 -0.009426834 0.0282929 0.00267509 -0.005820007 0.0006472 0.004931482 0.015819947 0.014574999 -0.00395602 0.007077357 0.003036179 -5.89E-05 0.005603843 -0.00083898 -0.001811646 0.015947571 -0.001499221 0.019297403 0.006698008 0.003692807 5.85E-05 0.013504569 0.017980867 0.017729636 -0.003044567 0.004273156 0.00315776 0.007578695 -0.003026555 0.020565412 0.022624809 0.019261188 -0.002912613 0.008977361 0.004597184 0.027731795 0.010477694 0.007135614 0.010052158]';
    %             break;  % 一旦施加了刺激，退出循环
    %         end
    %     end
    % end
    % [t,y] = ode45(@(t,y) wendModel_ode(t, y, pt, P, excs, i, stim), 0:0.001:0.001, yinit);
    % stim_duration_us = 345;
    % frequency = 1 / stim_duration_us;
    % if (i >= 1001) && (i <= 2001)
    %     % 在刺激期间分配刺激值
    %     stim_start = 1001; % 刺激开始时间
    %     stim_end = stim_start + stim_duration_us; % 根据脉冲长度确定结束时
    %     if (i >= stim_start) && (i < stim_end)
    %         pulse = 114.7 * 2 * pi * frequency * cos(2 * pi * frequency * (i - stim_start));
    %         stim = 0.551 * pulse *  [-0.008288155 0.011350203 0.001330774 -0.005082752 0.001697164 -0.003977708 -0.008418657 -0.004810917 -0.001968068 -0.006554444 0.011619756 -0.003831315 0.017484881 -0.005998375 -0.001512103 -0.002112704 0.000994136 0.01141731 0.00847799 -0.004561759 -0.008062828 0.001378504 -0.005138937 -0.00441773 0.017690486 0.01638853 0.014794653 -0.007721082 -0.005515299 -0.009426834 0.0282929 0.00267509 -0.005820007 0.0006472 0.004931482 0.015819947 0.014574999 -0.00395602 0.007077357 0.003036179 -5.89E-05 0.005603843 -0.00083898 -0.001811646 0.015947571 -0.001499221 0.019297403 0.006698008 0.003692807 5.85E-05 0.013504569 0.017980867 0.017729636 -0.003044567 0.004273156 0.00315776 0.007578695 -0.003026555 0.020565412 0.022624809 0.019261188 -0.002912613 0.008977361 0.004597184 0.027731795 0.010477694 0.007135614 0.010052158]';
    %     end
    % else
    %     pulse = 0;
    % end
    if (i >= 1001) && (i <= 2001)
        % 时间 t = r - stim_start /((r+1)*(r+1))
        r = i - 1001;  % 时间单位为毫秒 
        % stim = 0;
        % stim = 1000 * [-0.5707279521439742 -0.006598619669648519 -0.5986497321964788 -0.4551843527270387 -0.06352277408231169 -0.33057401033086026 -0.6012825543379874 -0.33766116235928595 -0.3817274380570266 -0.46329985307981375 0.35677234203100944 -0.36828099644590134 0.627090668080068 -0.3913962622500449 -0.253221059010044 -0.5447310254090125 -0.29743147141806536 0.38654574708394573 0.09438335603688049 -0.41537315173273454 -0.7101359229042475 -0.3778024736882859 -0.6537597384985679 -0.5107574132407685 0.4873802009989784 0.23625084790606798 0.005119798632160695 -0.6432887838062291 -0.4338877245133621 -0.6867381136552057 1.2029157269632273 0.029751406088484995 -0.5055712594686477 -0.2589244192138593 -0.09927016921455677 0.1896985477890878 0.019938838448486255 -0.41496201743252603 0.12373021339993924 -0.07924879673852872 -0.3218421630136588 0.025796455538534234 -0.3456445455497191 -0.29910484541729154 0.513095038614924 -0.2844957611526767 0.7017762786401024 0.04049645149450887 -0.0651671367549017 -0.4805968470417361 0.22597238443891393 0.5770180774527519 0.4822534983375494 -0.3596964734450596 -0.26748099608416687 -0.3095133233889734 -0.1715441166545541 -0.4614899575959378 0.6329260410947576 0.6548777251196158 0.252766217108886 -0.47811207380030724 0.10605514495495057 -0.18984525750519626 1.1517533714921564 0.28497722400185166 -0.018523824236028753 0.12676599362726548]'/((r+1)*(r+1));%F3 80%MT
        stim = P.D * 1000 * [-0.6329649803253155 0.07860606354617607 -0.5572242968315415 -0.4982909906982216 -0.03903589153411798 -0.3577445964915384 -0.6695458244680846 -0.3645250440617907 -0.39545534212154027 -0.5195583425261083 0.4393680941785612 -0.4003172573984795 0.7047696361523778 -0.4197590606572654 -0.2602313788374448 -0.5491544522527032 -0.24824908461724335 0.5036469778304183 0.2036233708929473 -0.454348245063421 -0.7576376542495499 -0.35827081917544185 -0.6677131402185874 -0.5426338909555408 0.5786695107935084 0.368895490581486 0.11350102323121963 -0.7007846011944409 -0.455707004496398 -0.7567317197533597 1.2980771783405172 0.08093839394009632 -0.540351436270583 -0.2383530424200298 -0.07313015549579906 0.2857864390428272 0.112837394835416 -0.4485225679201288 0.16284206857141795 -0.06580895981550217 -0.32512765830975726 0.05359086724931079 -0.35152468284312893 -0.3187280711108122 0.5823038622153789 -0.30021712656394645 0.7791742408608346 0.07387958816364547 -0.04549625805278425 -0.467093065236639 0.2935494502710125 0.6493389751921012 0.557911242227293 -0.38677592679015116 -0.2358364473591113 -0.27999455336391765 -0.11947106657263094 -0.4816173623553229 0.7219840939067182 0.7431599522969903 0.36115311390667765 -0.49726401051285146 0.15142888306600794 -0.16132527991790616 1.2339598076821703 0.3389888431446986 0.01975529041073931 0.17891198066993774]'/((r+1)*(r+1));%F3 MT
        % stim = 1000 * [-0.8549640073615983 -0.009884888753815588 -0.8967914960568524 -0.681876955270617 -0.09515862204393206 -0.4952077071751568 -0.9007355260633022 -0.5058244289884896 -0.571836755033721 -0.6940341672615343 0.534453429366933 -0.5516936666123133 0.9393966924997127 -0.5863208829750409 -0.37933115163923053 -0.8160199945847194 -0.44555939789472376 0.5790546962248884 0.1413885056840286 -0.6222388320419956 -1.063800453678371 -0.5659570653271886 -0.9793475924540531 -0.7651267178583774 0.7301070995205307 0.35390937295051883 0.007669579769448467 -0.9636618540018929 -0.6499741011481521 -1.0287499805345492 1.8019962866369343 0.04456831188781526 -0.7573577365159506 -0.3878749204820987 -0.1487090677163474 0.28417292336816463 0.029868852853982008 -0.6216229431100625 0.1853507939867907 -0.11871657693210015 -0.4821271928146061 0.038643702170693586 -0.5177837263370039 -0.44806615183032533 0.7686285361072625 -0.42618139714143566 1.0512775083188943 0.060664644729248485 -0.09762191632421581 -0.7199454744218832 0.3385119909186925 0.864386764247723 0.7224271773518265 -0.5388338475715264 -0.4006928755565928 -0.463658298673278 -0.25697715498812174 -0.6913229009042637 0.94813821966401 0.9810223629265432 0.37864978768517443 -0.7162232251787941 0.1588731222846135 -0.28439269800153427 1.7253538648047777 0.4269026399082326 -0.027749128005430255 0.18989846476211314]'/((r+1)*(r+1));%F3 120%RMT
        % stim = 1000 * [-1.035431344007651 -0.011971408807192753 -1.086087854063378 -0.8258087664093402 -0.1152448747179179 -0.5997370385048105 -1.0908643969999512 -0.6125947570069734 -0.692541083272834 -0.8405321445197118 0.6472668181517076 -0.6681461556068032 1.1376862318138345 -0.7100825469273614 -0.4594010517211954 -0.9882669591406644 -0.5396088750227016 0.7012826004414218 0.17123304514259632 -0.7535821211271843 -1.2883493621063282 -0.6854202981137337 -1.1860700394098576 -0.9266310382504525 0.884219416042214 0.4286131983756304 0.009288488428106877 -1.1670733271419393 -0.7871718005987542 -1.2459003722039157 2.1823648959536395 0.05397587112554427 -0.9172221663871966 -0.46974825462060477 -0.180098844542822 0.34415665389462546 0.036173623905152226 -0.7528362292544735 0.22447497213723178 -0.143775484991452 -0.5838954657040379 0.04680068415942519 -0.6270784442971262 -0.5426447590766383 0.9308720265786495 -0.5161405311024949 1.2731830509721582 0.07346984678311066 -0.1182281255745153 -0.8719128568854084 0.4099657093186134 1.0468430733239567 0.8749184021228579 -0.652571862889861 -0.48527184665013656 -0.5615281242505545 -0.3112203539300088 -0.8372485791952066 1.1482729362159796 1.1880983234389413 0.45857586424161134 -0.8674049085936483 0.19240834598604692 -0.34442281895153054 2.089544654209682 0.517014015086947 -0.033606463731974394 0.22998257341921977]'/((r+1)*(r+1));%F3 80%MSO
        % stim = 1000 * [-1.2937252195828988 -0.014957740634179978 -1.3570182664608081 -1.0318111711022204 -0.14399332385814415 -0.7493446439709612 -1.3629863435286163 -0.7654097889840124 -0.8652991530656496 -1.0502073744710614 0.8087309808493285 -0.8348187804807491 1.4214881349565824 -0.8872164284597046 -0.5740010962140912 -1.2347954271619495 -0.6742171891627057 0.876221288350746 0.21394804224208314 -0.9415672036309423 -1.6097349872944282 -0.8564020500400651 -1.4819415416159405 -1.157784096812195 1.1047926690632823 0.5355330485147299 0.011605551445219136 -1.4582059980742157 -0.9835360079380135 -1.556696870281283 2.726767468037582 0.06744044028395936 -1.1460281316410024 -0.586929464106927 -0.22502546262629758 0.43000836821003074 0.04519732747155085 -0.940635245049244 0.2804714521144671 -0.17964104715198184 -0.7295513062776214 0.05847536463021453 -0.7835065093781369 -0.6780103906985057 1.163083022315236 -0.644894541584843 1.5907853588940515 0.09179729222211784 -0.14772076256458946 -1.089416173036918 0.5122338437779135 1.3079836656887323 1.0931714675758104 -0.8153593973148097 -0.6063254990283578 -0.7016043121086198 -0.38885593241617183 -1.0461047062497038 1.4347157492803937 1.4844757919217222 0.5729700613124198 -1.0837836929817437 0.2404056349081392 -0.4303409295617982 2.6107927215448585 0.6459859208108977 -0.041989775491175545 0.2873529539341181]'/((r+1)*(r+1));%F3 100%MSO
        % stim = P.D * 1000 * [0.7502237535175653 -0.005445553718676128 0.7779264479027412 0.5927450600674765 0.08822696537444276 0.4381657718520696 0.7837362281479555 0.4560911953405526 0.49625716526909336 0.6060348519247462 -0.49309549317434226 0.48077682551804113 -0.890983348608809 0.5324174973105594 0.3340396622472672 0.7100626717687041 0.4041971857572058 -0.49784015583161134 -0.10594012246343622 0.5412401200217297 0.9246192548877997 0.491578921042761 0.8535580176519518 0.6647926926124358 -0.6926498234283989 -0.33753421241914305 -0.02899700436832844 0.835414062244062 0.5828986387183133 0.8944751792497203 -1.7202085175122945 -0.020878847623854068 0.6654507519612619 0.34139091082967965 0.11917210474149637 -0.27154483093843235 -0.025716553325155246 0.5388598609864932 -0.18130901038017824 0.0924541650373456 0.4149125372118644 -0.05019468541651877 0.446703341910275 0.3860939155627791 -0.7286313576522611 0.3675064487470388 -0.9983307928377305 -0.07082544908484247 0.07427178489602883 0.6254621518225221 -0.3201271567886258 -0.8171465519025668 -0.6791862242984301 0.46644162998807925 0.34465664277662644 0.40024049184226096 0.2197798912777904 0.5983755750282197 -0.8968412338002718 -0.9195133531817661 -0.3562732771263525 0.62073025199842 -0.15994924502339417 0.2412282838099832 -1.6508261079346431 -0.4057471504196555 0.010542836036823 -0.18797560695433974]'/((r+1)*(r+1));%F3 reverse
        % stim = P.D * 1000 * [-0.6520559107592724 0.5852645508257702 0.35933243063443554 -0.7819362259195489 0.30095049415566044 -0.2806772685978651 -1.0423938455035788 -0.10364019532846772 -0.39708809190315164 -0.7974185924729346 0.8108014837046135 -0.5214463326206914 0.8490608395488598 -0.015340239401695552 -0.0836923782087856 -0.43912367679354225 0.6490168099593355 1.0380678255455615 0.9799597640422348 -0.6748939023919209 -0.5327184437487675 -0.10353764956151545 -0.09704438413626172 -0.7203409580079031 0.8637781280771727 1.0527659723915321 0.728195219781022 -1.0855668386780462 0.010409899099341239 -0.931940988546531 1.1772518154954603 0.5806477396387667 -0.24583556448273783 0.26691884025369683 -0.039409060903129005 0.7069494549508574 0.5406384638869199 -0.697099626507145 0.2764114501769305 -0.07656817086252495 -0.444498393990893 0.06942846750832783 -0.3689530191551949 -0.5079018934086452 0.6681825256710733 -0.40981486261085626 0.8565782683406424 0.10136390615616128 0.012820693714475874 -0.285428611984704 0.46719058660550156 0.7005900847439718 0.6689366467873283 -0.5753728811819502 -0.1023680832807471 -0.03026161882944533 0.14279770792934787 -0.6367352426011947 0.8922234011428402 0.8663580138231737 0.7936398633383664 -0.6914126256650378 0.23280411140207483 -0.09551984378046466 1.1034066190667053 0.43698722281567237 0.12569250608637 0.32517697182521244]'/((r+1)*(r+1));%C3 MT
        % stim = 1000 * [-0.5441319645393787 0.5213971036377983 -0.08631810272313108 -0.3803822804229116 0.14312306449913642 -0.27324323463363615 -0.5609640249718452 -0.3197943477603729 -0.20492314244369406 -0.45757954994734334 0.9199120026609788 -0.29562278832863964 1.1136232655417448 -0.361235370148547 -0.12221276415634816 -0.26312402624349657 0.2076209977954961 1.1437457938628732 0.8569563626994947 -0.34603772213230627 -0.521367921966787 -0.05198995014036224 -0.34738110083981083 -0.35336980273901547 1.032421109836082 1.1225763721688913 0.6505114594884912 -0.526920327085156 -0.3005448912169304 -0.6039087619371182 1.8534494667434107 0.34635834569382457 -0.39089228865178915 0.05544852493972991 0.13452927880112597 0.7115549050587442 0.46459427639415046 -0.31835702762064666 0.37070745813981903 0.09425821520241404 -0.13561549115399107 0.23168572804495882 -0.15204081117623366 -0.19843088772549672 0.8868471800360769 -0.1714986250970625 1.1657766840071313 0.26951129603998175 0.13676418916890823 -0.16915634871746066 0.5674553112322094 0.9265045467807627 0.8388525250133102 -0.263383891407583 0.0376090325168697 0.02369633032565929 0.18097825586830582 -0.28175083293513803 1.13650395347688 1.0680819698151127 0.7905926865003157 -0.2926201976402476 0.3778232542360689 0.07758234163333978 1.6455441015042365 0.5728448206923473 0.2541075698869322 0.4395426999603707]'/((r+1)*(r+1));%F7 MT
        % stim = 1000 * [0.33942465530803384 1.2714764989374736 1.3707200758770044 -0.3045592684414503 0.6530115935742608 0.2583216616211206 -0.03420030079185196 0.4101946646253424 0.4813569990901711 -0.3168125662683161 0.997849801596709 0.009268525467980888 1.0742069405002672 0.5131743266921706 0.46645393183786743 1.1506516436808982 1.0274446944241902 1.044848775914587 1.0856651613963515 -0.1824069071943209 1.0234530082623652 1.0297257146875793 1.1866795399560348 0.35274377397688805 1.1750438354464983 1.2742319191926021 1.4402781861549547 0.27530002385125507 0.6696791456999145 0.5516218765434413 1.24483756461753 0.7701921791126619 0.6628748399522557 0.8648321996754336 0.6716305260220841 1.2953549077297284 1.4500568581112514 -0.2458135609134013 0.6846872009453363 0.3519649814145304 0.2811061040849964 0.5178182398205959 0.505265870174227 -0.20918907632842887 1.0152013771515116 0.06133697291730636 1.1020329086474348 0.6317910335581698 0.5202633982908619 1.2522847105230623 1.115558231268271 1.0852137083553555 1.1548621975309967 -0.12336218109646507 1.238457873410074 1.0622824587713253 1.340271795828448 0.41286911753960703 1.2019453480594153 1.308426447643748 1.456763633782936 0.39034599215370386 0.844397052420929 0.9195468925334427 1.244403748926313 0.8136170682853362 0.8483078201038652 0.9388288161229741]'/((r+1)*(r+1));%Pz MT
        % stim = P.D * 1000 * [-0.5532187910535521 0.020627524662842456 -0.16369373030142398 0.5128932853121833 -0.15798961697941602 -0.2974990526873207 -0.2620107282897468 -0.46554945032148576 0.14557405312632557 0.05075095147188146 -0.16165917845058383 0.17094365335208686 -0.04611491818432951 -0.5287506941509484 -0.1575468627149545 0.18507574402081542 -0.28757497245671765 -0.23919919667046924 -0.2571145092959475 0.376926537797492 -0.2811605950524362 0.117573607423153 -0.19349932858882427 0.25691829324034227 -0.03481073401633631 -0.1770436529647837 -0.015249503580671826 0.169972962658459 -0.4288207538529401 -0.43282415050110623 -0.07662918558840795 -0.23812448029505354 -0.3217743656838606 -0.2220506334336069 0.5565732124492851 0.05502763185703607 0.25033132009845827 0.7521238639297698 0.18222059080315434 0.4919137202191071 0.829218239366177 0.47505031820309057 0.35267056490615645 0.9646615113620894 0.10815738791445509 0.5482774160350419 0.0016967974602773463 0.4915297959289625 0.31879379969658006 0.28965081133893955 0.2919550540841337 0.16910771605915148 0.21167420628961758 0.7000040521054304 0.4760006745875114 0.20306287009317248 0.3672131945127005 0.5305871431153039 0.012682637470594425 0.1433196622329726 0.0866143280204762 0.7723147959096897 0.39490178733075887 0.5827404484360474 -0.00702795859529662 0.1728678502849734 0.39545246235240133 0.27336911433669125]'/((r+1)*(r+1));%O1 MT
        % stim = P.D * 1000 * [-0.05783491624082993 0.34689718551898935 0.19138914121908884 -0.3739331621687495 0.2623060047702946 -0.005812911146755301 -0.26774794363844656 0.12121519728821134 -0.2503086063553246 -0.2567947510220755 0.7820699440272421 -0.23114996897783752 1.0023965147322909 0.18770924392870048 0.030290910667943406 -0.3742116892226332 0.4636179380760623 0.8780069168222334 0.7527672431661151 -0.31768563331595584 -0.09726261634622127 -0.18465244437507158 0.009325591153233082 -0.386072987731464 0.925752049940875 0.9454837219964927 0.5297971406504407 -0.3988194127079868 0.19816720312585231 -0.14184173063438957 1.6247086325778695 0.46026949005983536 0.05251806480287529 0.27444523721681624 -0.561080846634043 0.39407706105501306 -0.3646948409691522 -0.4101221891558911 0.038987961288204434 -0.27863734615739394 -0.6185842674582658 -0.33228462267861125 -0.32122708207486855 -0.4500506598843452 0.622007171814215 -0.31785880885557133 1.0038331027876504 -0.421988471862439 -0.17653522110021214 -0.4331611771217422 -0.2789248035188624 0.6218448814119159 0.2972574183066214 -0.36894372000674197 -0.6727150857546066 -0.23059162379753353 -0.6023294661123056 -0.4602487381701136 0.9188050573538618 0.7265162546792433 0.44042313288356916 -0.6083015726127347 -0.3770277398009392 -0.6842635789024047 1.7590110186932106 0.15410553821485104 -0.4299796101980604 -0.12305743716836569]'/((r+1)*(r+1));%F4 MT
        % stim = P.D * 1000 * [-0.9616592498919082 0.38675784416311054 0.3740651928900766 -0.8232062842916728 0.1839110396158855 -0.5754142514072837 -1.1015589471257128 -0.453669380737394 -0.40094526787888735 -1.1030991183444392 0.6594985672953301 -0.6920230110175319 0.6176126408595766 -0.3550080633132555 -0.24949016990542275 -0.232912178213696 0.47967186535889095 0.7850146810159989 0.7551370310379902 -0.7900861144911026 -0.3432154008721164 -0.07469038099046715 0.01252539243815014 -0.5708359731184122 0.6010129079290331 0.7862906527978338 0.5058127600067283 -0.7746861437524268 -0.24731270976101083 -0.8566515146446574 0.8457209962268425 0.584673744727309 -0.44462746842318285 0.12864349238155795 -0.08609244603507488 0.44876129626805533 0.29234189130010957 -0.7045553325015518 0.17795126255845747 -0.15374588197306235 -0.3711691150488128 -0.0102650807262735 -0.34314264791439303 -0.5666641079615351 0.4727449435654702 -0.5028545069526253 0.6116969583796367 0.020737421749484786 -0.06607149786228733 -0.14632112823683358 0.28012690729102313 0.47496521670011654 0.4302258584174988 -0.6432073393568517 -0.06083464854845953 -0.03258790104317246 0.07727655492435247 -0.4755710955365703 0.6080617823100205 0.5434601229468358 0.48546857588446507 -0.4890624288914804 0.12490722300771899 -0.09852966012099153 0.7728324363460741 0.32207527389259505 0.03848129133715849 0.1948353045979118]'/((r+1)*(r+1));%T3 MT
        % stim = P.D * 1000 * [-0.43864065213238734 0.05644425299534126 -0.44265530926147867 -0.33504003984936787 -0.03790662130396198 -0.2481939516258122 -0.4537389948935429 -0.260060209530137 -0.27355092784402085 -0.3473823903077582 0.32986513399298 -0.2713391595775264 0.5398427255582244 -0.3051898837569454 -0.1843582953191288 -0.3874844037417364 -0.21030042046962363 0.3990362396797431 0.15106544940331795 -0.3058115768487733 -0.5449991787963656 -0.25649251182717453 -0.5004069321577022 -0.37211610961161884 0.4420872201866789 0.2865472816208022 0.08830449598137827 -0.4789702997087614 -0.3357239503983993 -0.5266392284703892 1.0216904468347163 0.030529894909989558 -0.3883321551440551 -0.17998757640228755 -0.04923621865289558 0.21553679450853874 0.08274466876785029 -0.3020769373625474 0.11313245808971285 -0.04417591990905135 -0.22037005172559954 0.03743393182257757 -0.2428680647895786 -0.21326489516850428 0.4274330968382447 -0.20310884093347345 0.5924171164653624 0.05203132451465755 -0.03178958158538149 -0.3318049817573121 0.21034008684496755 0.4694817419092177 0.4028513748117743 -0.26048384746326986 -0.16428426575191246 -0.20023476677774996 -0.08462806319907637 -0.33017578714897505 0.5509820686841548 0.5518647397562 0.27712032846948315 -0.33855386431038076 0.10728304521586401 -0.11046875968881542 0.9411232348648635 0.23828652830903455 0.0157815951604614 0.12935142978110933]'/((r+1)*(r+1));% Deymed 50mm
        % stim = P.D * 1000 * [-0.6216308868216761 0.100811678493459 -0.5618722844633399 -0.4763554147337358 -0.04248761551243472 -0.35145055761110255 -0.6466953847435357 -0.36759749644700374 -0.37877983885856636 -0.49986690140914125 0.45886873247573806 -0.38449707005168415 0.7489861944626457 -0.428800848987359 -0.2549535443480508 -0.5303426284487818 -0.262304830445386 0.5186588004459848 0.20418927701154388 -0.43474284906405825 -0.7480636400386561 -0.3425886248577036 -0.6677123422046557 -0.521077693506454 0.6197683583912096 0.39884673748078414 0.14357942273832694 -0.6752913978517555 -0.46300316831007277 -0.7393919123985679 1.3886108247861864 0.06322659766763948 -0.5370163772869696 -0.23741529298926284 -0.052936435732461 0.31945110010421635 0.1434265779134086 -0.42692773560621355 0.17562463515356236 -0.05087192052536799 -0.30216942602670355 0.06922501230088852 -0.3332106630726958 -0.2990248427693129 0.615187798981536 -0.2832607018082346 0.8278541940621102 0.09191968585895516 -0.031729093649677034 -0.44778524233933475 0.32112674563094185 0.6840076335491814 0.592615274996893 -0.3671941198148863 -0.21204964346722896 -0.26211762031029406 -0.09545226305173492 -0.4591737453912835 0.7727759898449437 0.794120452095421 0.40472779071348874 -0.47186043315230164 0.1722616277757857 -0.1382062566397195 1.3108662494965737 0.3557255533666108 0.040741488357390804 0.20172785641083177]'/((r+1)*(r+1));% Deymed 70mm
        % stim = P.D * 1000 * [0.14561731817536497 -0.04354446669106804 0.18355417957017736 0.13620435913686768 0.02514291005697727 0.0892178785798301 0.16093228835631423 0.10013889354304237 0.10905219594244829 0.12526517292648479 -0.20239496458720374 0.1038835873629601 -0.3669644759889085 0.1167775567384212 0.06682358903363708 0.16692718394513612 0.07151519740026849 -0.22414609942022828 -0.09535626040703586 0.12077146230137012 0.19046395282391368 0.10875019546051862 0.19477430273102145 0.15317345799800278 -0.28009121733203685 -0.17960782731948846 -0.06383277253093439 0.18591610222041574 0.12427919900453335 0.1768777924138798 -0.7284982207904537 0.03550923617900642 0.14030716875581734 0.05749486572409672 0.04382046715807391 -0.14049440633990692 -0.033078979935924235 0.13456344642699108 -0.04488269308238057 0.03381532285651399 0.12471914418190937 0.0021700380787155896 0.11237135442717334 0.10473985313728677 -0.252893742897113 0.0930662821987618 -0.4118560660028237 -0.004429589064853013 0.02510218382584185 0.1762984432592904 -0.10609785860248123 -0.2698253308181997 -0.229666301703483 0.11561018869925781 0.10880526919585996 0.0997485253935048 0.06431757561029891 0.15777726542278223 -0.37812476624229313 -0.3582749077373084 -0.1803121223701265 0.17257457949049443 -0.03889241752888965 0.08138105283117379 -0.6641168213410338 -0.10352796847814302 0.0004802448982851891 -0.0642432241209963]'/((r+1)*(r+1));%F3 MagVenture MC-B70
        % stim = P.D * 1000 * [0.3936216690022766 -0.014248341600436547 0.44218219177878965 0.3036639013167414 0.046845103666061684 0.226589250776654 0.40813085214153255 0.23685213743067488 0.2551018752110707 0.3113691010553963 -0.26605125406671387 0.24657583291780918 -0.4792954392266183 0.2787070418404021 0.1729062160824584 0.36787680603800105 0.22907007879836 -0.286607188611132 -0.063209524802263 0.27720444983127457 0.4993720549717583 0.25265875326333026 0.4695671019709778 0.3428177391579726 -0.37841270356433454 -0.18285921846436765 -0.03037058631499152 0.43607392461679334 0.31078209765185977 0.47496701595608537 -0.9281998405485887 -0.005005897757890877 0.3547654030995605 0.18365278855827277 0.04945957861380896 -0.16722991704119838 -0.05265709711506143 0.275124241624539 -0.09853984954834899 0.04226041637072727 0.20548139145694247 -0.03286051775595239 0.22791177588699013 0.19412123542095563 -0.3901942766537647 0.18612871076151977 -0.5367429206029642 -0.046031098323487896 0.033198764872513935 0.3203691271155352 -0.18830889724768998 -0.43745979350380676 -0.37320036001254264 0.23752255291430577 0.1625843693034534 0.20139114487149967 0.09294878242898752 0.30651480223439714 -0.49311224601160536 -0.5121547166636897 -0.22680002328513485 0.3145413150655101 -0.09549363252981546 0.10928865084986084 -0.8780917764961792 -0.21484737534969747 -0.008565806204943233 -0.11212747454100892]'/((r+1)*(r+1));%F3 MagVenture Cool-B65
        % stim = 1000 * [-0.01955387765007546 -0.09723719244791322 -0.09282641928720686 -0.10439382099675731 0.050222245900371505 -0.0033897098138867122 -0.08279883817869235 0.05617035076027956 -0.09444797822687101 -0.07234512917121702 -0.04162230596633091 -0.07112175967804964 -0.26796178184865915 0.07871582000834161 -0.015136809264201844 -0.13886719817135587 -0.009223408207610032 -0.022878424907753468 -0.0201031227719029 -0.09296014341714079 -0.06722969242441067 -0.09268509483839707 -0.07356647732738586 -0.1158974258001424 -0.24597321246195955 -0.13725306084019573 -0.14405185035750173 -0.13058924973546088 0.03937898636395201 -0.05662716266396736 -0.3749947385949967 0.20428682401240292 -0.04096403534965158 -0.04657835266567811 -0.14306154102671653 -0.14457578913931787 -0.19514453720872332 -0.1284627847702981 -0.04990476482070595 -0.08596191748006575 -0.1889046212741246 -0.08968258473055404 -0.13791507874771197 -0.12623355239319453 -0.14496024244992198 -0.10379288704009008 -0.22966926833406276 -0.10809427355702159 -0.07526677498494064 -0.23171634224435475 -0.1304877803671163 -0.1510454334289493 -0.14642086208553204 -0.12092859220054941 -0.23896684746126876 -0.1534747243975597 -0.21939119042701372 -0.17887775486493285 -0.2075026154730336 -0.20048976896459555 -0.18949872248069036 -0.2173663233990107 -0.11866004596593348 -0.20379350220053696 -0.4045280372036092 -0.08412004818466123 -0.12496760714362636 -0.11120023807162928]'/((r+1)*(r+1));%F3 MagVenture MC-125
        % stim = 1000 * [-0.21183491264254894 -0.29980140290863677 -0.39851040637527874 -0.11106128457326579 -0.058060828279244546 -0.11649401161109754 -0.19306985749431563 -0.08729236864834397 -0.14787453497233113 -0.1313462837021456 -0.3197607526499498 -0.11461820013286514 -0.4788058449373692 -0.10525641297420607 -0.12216946765294577 -0.19210159798969087 -0.3070058792855067 -0.3418388018319303 -0.3516512869959129 -0.11251202483717243 -0.3134672542013479 -0.19329722649517816 -0.3067210894818369 -0.1502637259289949 -0.43296834817161794 -0.5109935081297811 -0.38243408033708176 -0.19245754715314756 -0.16926104269924402 -0.27096031850566893 -0.8458907011038146 0.04474142416559035 -0.20265065619845005 -0.22703678385606668 -0.04564784860306693 -0.3477396075537824 -0.17336676683053637 -0.08095651809997448 -0.07597246248942771 -0.042308611240875926 -0.031766384766959956 -0.03374668656563105 -0.1065187763518464 -0.04355087593603544 -0.2870061307075661 -0.06938039494304414 -0.525777118646417 -0.04269224524000556 -0.0625527290697084 -0.10933564947269384 -0.16580766296978627 -0.28423699825595894 -0.2688356050292465 -0.0774848537603739 -0.05175336524015321 -0.14897843563214433 -0.08888224253229325 -0.09268196926750097 -0.5252876051722919 -0.4548305588387096 -0.3807880561520192 -0.061357560698213014 -0.08316402657446616 -0.03602419518866797 -0.7708688646602725 -0.08889186461598059 -0.09636717534798392 -0.14348546059428674]'/((r+1)*(r+1));%F3 MagVenture Cool-DB80
        % stim = P.D * 1000 * [-0.31220224051322204 -0.5088334042441923 -0.7026588250034386 -0.07496971410701501 -0.08460929541344504 -0.15079312180285412 -0.26512791942537767 -0.072558484376741 -0.16971760930600518 -0.14988823565968543 -0.6814535552954796 -0.11269503106148049 -0.9496603034703421 -0.13123676412543972 -0.1610308468922722 -0.2622745910045592 -0.5733235016793943 -0.7670056432209258 -0.7269846817996186 -0.09312909404602954 -0.5389349417292418 -0.2631388527633409 -0.5243536916774716 -0.15703041527835399 -0.8080016365316862 -0.9232477670134099 -0.6622901979902276 -0.25106908740603007 -0.2729631558048221 -0.43286057409855705 -1.6390499546027462 -0.02385779200947132 -0.2742313982844159 -0.37699122256376366 0.12650013584911002 -0.62283893795517 -0.20553620072802428 0.013309638975304598 -0.037962499728313275 0.07783588163752884 0.18317170860475376 0.11014689828028881 -0.042057269069334206 0.09313473772988436 -0.49388460220556635 0.016739048855516213 -1.0556809416884858 0.10770044052805654 0.02487461969605205 -0.011792097452142289 -0.18406550073680294 -0.4839247190054917 -0.43711111395549856 0.00721700152430177 0.16572737105958307 -0.13593219285664251 0.042649431633658405 0.018182781354378764 -1.0221996369287898 -0.8501487146313864 -0.6680130805465434 0.11641491400021015 0.01327106773304394 0.19741845774028255 -1.531897986242057 -0.04789590932691112 -0.018534273062709442 -0.14300404968364297]'/((r+1)*(r+1));%F3 MagStim DCC
        % stim = P.D * 1000 * [-0.726969865708301 0.006533021226709882 -0.773167205513108 -0.5705055848424107 -0.08544855314217535 -0.42244622135257026 -0.7572512467101689 -0.4397804477793795 -0.4797053716155477 -0.5828976371876089 0.47941462619150277 -0.46315670299980344 0.8575187445795198 -0.514474365252016 -0.3230645890531196 -0.6886580386600654 -0.3990859926432491 0.501874347060314 0.11166093917133588 -0.5209769899714842 -0.9048860881848685 -0.4766321299756989 -0.8402838022392136 -0.6421524466623922 0.66922148437696 0.32747173756825115 0.028295470804906398 -0.8087439896598219 -0.5670313127859752 -0.8699135503018166 1.6561757321612758 0.021685485582358072 -0.648947529941511 -0.33421416348678884 -0.11288074694019193 0.2691889350299576 0.04021674498052635 -0.5188703492155499 0.17265912970848193 -0.0896051056507231 -0.39840006645308335 0.04726069629578666 -0.4319184043548754 -0.370936573222243 0.6985154831153056 -0.3539857495632637 0.9598504281609628 0.06788645553198454 -0.07234337544533849 -0.6067312429428257 0.3137890224393477 0.7828506754825642 0.6560189929245069 -0.44911582823744917 -0.32941129444166084 -0.38739539763792996 -0.20676721656954716 -0.5781819678415234 0.8681114162015705 0.8936920141481692 0.3569400805988557 -0.5980320854393395 0.15478444675218198 -0.22908384346072264 1.5783752957539696 0.38646240409556076 -0.0077059543810051425 0.18300858455720698]'/((r+1)*(r+1));%F3 Magstim_70mm_Fig8
    end
    %pulse_array(i) = pulse; 
    stim_array(i,:) = stim;
    [t,y] = ode45(@(t,y) wendModel_ode(t, y, pt, P, excs, i, stim), 0:re:0.001, yinit);
    Nnode = y(end, 2:8:end) - y(end, 3:8:end) - y(end, 4:8:end);
    % d1= t';
    excs(:, i) = Nnode';
    % d2= excs';
    yinit = y(end,:)';
    
end
excs = excs';
save('Data/stim.mat', 'stim_array');
end